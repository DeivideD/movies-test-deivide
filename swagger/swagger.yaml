---
openapi: 3.0.1
info:
  title: IA Movies
  description: "The best movies"
  version: 1.0
servers:
- url: http://127.0.0.1:3000/api/v1
- url: http://localhost:3000/api/v1

tags:
  - name: movies
    description: All endpoints to movies
    externalDocs:
      description: Find out more
      url: http://swagger.io
  - name: ratings
    description: All endpoints to ratings
    externalDocs:
      description: Find out more
      url: http://swagger.io
paths: 
  /movies:
    get:
      tags:
        - movies
      summary: Returns a list of movies.
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: page
          in: query
          description: page of request
        - name: per
          in: query
          description: quantity per page
      responses:
        '200':    # status code
          description: A JSON array of movies
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/by-year/{year}:
    get:
      tags:
        - movies
      summary: Returns a list of movies filtered by year.
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: year
          in: path
          required: true
          description: Parameter description in CommonMark or HTML.
        - name: page
          in: query
          description: page of request
        - name: per
          in: query
          description: page of request
      responses:
        '200':    # status code
          description: A JSON array of movies
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/by-genre/{genre}:
    get:
      tags:
        - movies
      summary: Returns a list of movies filtered by genre.
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: genre
          in: path
          required: true
          description: Parameter description in CommonMark or HTML.
      responses:
        '200':    # status code
          description: A JSON array of movies
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/by-parental_rating/{parental-rating}:
    get:
      tags:
        - movies
      summary: Returns a list of movies filtered by parental rating.
      description: Optional extended description in CommonMark or HTML.
      parameters:
        - name: parental-rating
          in: path
          drequired: true
          escription: Parameter description in CommonMark or HTML.
          schema:
            type: string
            default: available
            enum:
              - N/A
              - G
              - PG
              - PG-13
              - R
              - NC-17
      responses:
        '200':    # status code
          description: A JSON array of movies
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/count-by-year:
    get:
      tags:
        - movies
      summary: Returns a list of years and number of movies released that year.
      description: Optional extended description in CommonMark or HTML.
      responses:
        '200':    # status code
          description: A JSON array with movies and quantity by yar
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  "2016.0":
                    type: 10
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/count-by-year:
    get:
      tags:
        - movies
      summary: Returns a list of years and number of movies released that year.
      description: Optional extended description in CommonMark or HTML.
      responses:
        '200':    # status code
          description: A JSON array with movies and quantity by yar
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  "2016.0":
                    type: 10
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/{id}/ratings:
    get:
      tags:
        - movies
      summary: Returns a movie by id and its ratings.
      description: Returns a movie by id and its ratings.
      parameters:
        - name: id
          in: path
          required: true
          escription: id - interger.
      responses:
        '200':    # status code
          description: A JSON array with movies and its ratings
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: the last man
                  total_ratings: 
                    type: integer
                    example: 1
                  ratings:
                    type: array
                    example: [{
                      id: 1, 
                      grade: 5
                    }]

        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/year-more-release:
    get:
      tags:
        - movies
      summary: Returns the year that had the most movie releases.
      description: Returns the year that had the most movie releases.
      responses:
        '200':    # status code
          description: A JSON with the year that had the most movie releases.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  year: 
                    type: integer
                    example: 4
                  movies: 
                    type: integer
                    example: 120           
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/best-rating-by-parental-rating/{parental_rating}:
    get:
      tags:
        - movies
      summary: Returns the movie with the best rating by parental rating.
      description: Returns the movie with the best rating by parental rating.
      parameters:
        - name: parental_rating
          in: path
          required: true
          description: parental_rating - string.
      responses:
        '200':    # status code
          description: A JSON with the movie with the best rating by parental rating.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/best-rating-by-genre/{genre}:
    get:
      tags:
        - movies
      summary: Returns the movie with the best rating by genre.
      description: Returns the movie with the best rating by genre.
      parameters:
        - name: genre
          in: path
          required: true
          escription: genre - string.
      responses:
        '200':    # status code
          description: A JSON with the movie with the best rating by genre.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/search?title={title}:
    get:
      tags:
        - movies
      summary: Returns the movie by title.
      description: Returns the movie by title.
      parameters:
        - name: title
          in: path
          required: true
          description: title - string.
      responses:
        '200':    # status code
          description: A JSON with the movie by title.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/{id}:
    get:
      tags:
        - movies
      summary: Returns the movie by id.
      description: Returns the movie by id.
      parameters:
        - name: title
          in: path
          required: true
          description: movie's id.
      responses:
        '200':   
          description: A JSON with the movie by id.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /movies/:
    post:
      tags:
        - movies
      summary: Create a movie.
      description:  Create a movie.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              schema:
              type: object
              properties:
                title: 
                  type: string
                release_date:
                  type: string
                  format: date
                runtime:
                  type: string
                genre:
                  type: string
                parental_rating:
                  type: string
                plot:
                  type: string
              required:
                - title
                - release_date
      responses:
        '200':    # status code
          description: A JSON with the movie by title.
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  id: 
                    type: integer
                    example: 4
                  title: 
                    type: string
                    example: vinkings
                  release_date: 
                    type: date
                    example: 2022/01/01
                  runtime: 
                    type: string
                    example: 160 min
                  genre: 
                    type: string
                    example: fantasy
                  parental_rating: 
                    type: string
                    example: G
                  plot: 
                    type: string
                    example: The vinkings
                  average_rating: 
                    type: float
                    example: 4.0
                  total_ratings:
                    type: integer
                    example: 6        
        default:
          description: Unexpected error
  /movies/{id}:
    delete:
      tags:
        - movies
      summary: Delete movie by id.
      description: Returns the year that had the most movie releases.
      parameters:
        - name: id
          in: path
          required: true
          escription: id - integer.
      responses:
        '200':    # status code
          description: A JSON with the year that had the most movie releases.
          content:
            application/json:    
            schema: 
        default:
          description: Unexpected error
  /ratings/average-rate:
    get:
      tags:
        - ratings
      summary: Returns the year that had the most movie releases.
      description: Returns the year that had the most movie releases.
      responses:
        '200':    # status code
          description: A JSON with the year that had the most movie releases.
          content:
            application/json:
              schema:        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error
  /ratings:
    post:
      tags:
        - ratings
      summary: Create a rating.
      description: Returns the year that had the most movie releases.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              schema:
              type: object
              properties:
                movie_id: 
                  type: integer
                grade:
                  type: integer
              required:
                - movie_id
                - grade
      responses:
        '200':
          description: A JSON with the year that had the most movie releases.
          content:
            application/json:
              schema:        
        '404':
          description: nothing for this search.
        default:
          description: Unexpected error